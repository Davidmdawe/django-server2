
<!DOCTYPE html>
<html >
{% load static %}
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon"
        href="{% static 'app_management/images/logo.jpeg' %}"
        type="image/png" />
    <title>|Analytical And Data Visualizations</title>
    <link rel="stylesheet" type="text/css" href="{% static 'css/controls.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'system_management/css/user_engagement.css' %}">
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/raphael"></script>
    <script src="https://cdn.jsdelivr.net/npm/justgage/justgage.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <script src="https://code.highcharts.com/stock/highstock.js"></script>
    <script src="https://code.highcharts.com/stock/highcharts-more.js"></script>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/data.js"></script>
    <script src="https://code.highcharts.com/modules/drilldown.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>
    <script src="https://code.highcharts.com/modules/export-data.js"></script>
    <script src="https://code.highcharts.com/modules/accessibility.js"></script>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.14.0-beta2/css/bootstrap-select.min.css" />
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <script src="https://code.highcharts.com/maps/highmaps.js"></script>
    <script src="https://code.highcharts.com/mapdata/index.js"></script>
    <script src="https://code.highcharts.com/modules/accessibility.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.js"></script>
    <script src="https://www.highcharts.com/samples/static/jquery.combobox.js"></script>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/base/jquery-ui.css" rel="stylesheet">
    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
    <!-- Add these links to your HTML -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css">
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>

   
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            background-color: white;
        }

        header {
            background-color: white;
            color: #0a0606;
            padding: 1%;
            text-align: center;
            position: relative;
        }

        header img {
            position: absolute;
            top: 1%;
            left: 1%;
            max-width: 5%; /* Adjust the size as needed */
            height: auto;
        }

        nav a {
            display: inline-block;
            color: black;
            text-decoration: none;
            position: fixed;
            top: 1%; /* Adjust the top margin */
            right: 0;
            margin: 0 2%; /* Adjust the percentage margin */
            padding: 1% 2%; /* Adjust the percentage padding to control button size */
            background-color: #FFC72C; /* McDonald's red color */
            font-family: 'Speedee', sans-serif;
            border-radius: 5px;
            transition: background-color 0.3s ease;
        }

        nav a:hover {
            background-color: #FFC72C; /* Lighter shade for hover effect */
        }

        

        .dashboard-content {
            background-color: white;
            border: 2px solid #FFC72C;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            text-align: center;
            margin-bottom: 20px;
        }

        h1 {
    font-family: 'YourMcDonaldsFont', sans-serif; /* Replace 'YourMcDonaldsFont' with the actual font name */
    /* Add any additional styles as needed */
}
h2 {
    font-family: 'YourMcDonaldsFont', sans-serif; /* Replace 'YourMcDonaldsFont' with the actual font name */
    /* Add any additional styles as needed */
}

select {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-right: 20px;
        }

        .form-control.textbox {
    width: 100%;
}

.form-control.textbox.topMargin {
    margin-top: 1vw;
}

.mcdonalds-yellow {
    background-color:  #669999; /* McDonald's yellow color */
    color: black; /* Text color */
    /* Add any additional styles as needed */
}
/*.container {
    width: calc(100% - 600px); 
        }*/


        h1 {
    font-size: 30px;
    margin: 0 auto; /* Center horizontally */
    text-align: center; /* Center text inside the element */
}

        .container {
            display: none;
        }
        .container.active {
            display: block;
        }
        @import url('https://fonts.googleapis.com/css2?family=Speedee&display=swap');

        .green-text::before {
    content: '\2713'; /* Unicode character for checkmark */
    margin-right: 5px; /* Adjust as needed */
}
.red-text::before {
    content: 'X';
    margin-right: 5px; /* Adjust as needed */
}

    </style>
</head>

<body>

    <header>
        <div style="display: flex; align-items: center;">
           <!--<img src="{% static 'app_management/images/mcdonalds-clip-art-png-31.png' %}" alt="Logo" style="margin-left: 5%;">--> 
            <img src="{% static 'app_management/images/logo.jpeg' %}" alt="Logo" style="margin-top: 1%;">
            
        </div>
        <form method="post" action="{% url 'visuals' %}">
            {% csrf_token %}
            <button class="btn" style="text-align: center; background-color:  #669999; font-family: 'Speedee', sans-serif;" type="submit"> Store Visualisations</button>
        </form>
        

        
    </header>
    <nav>
        <a class="btn" style="text-align: center; background-color:  #669999; font-family: 'Speedee', sans-serif;" href="{% url 'logout' %}">Logout</a>
    </nav>
    <div id="Home" class="container active"   style="max-width: 100%; padding: 0; margin: 0;">
        <h1 style="font-weight: bold;font-size: 200%;font-family: 'Speedee', sans-serif;">Analytical And Data Visualizations Landing Page</h1>
        <hr>
        
        <div class="row">
            <div class="col-sm-3">
                <label for="filter_main" style="font-weight: bold;font-family: 'Speedee', sans-serif;">Select Month:</label>
                <select id="month_main" class="form-control drop-down-list">
                    <!--  <option value="all">All</option>-->
                    <!-- <option value="December_2023">December 2023</option>-->
                    <option value="January_2024">January 2024</option>
                </select>
            </div>
            <div class="col-sm-3">
                <label for="filter1" style="font-family: 'Speedee', sans-serif;">Select Province:</label>
                        <select id="filter1" class="form-control drop-down-list">
                            <option value="all">All</option>
                            <option value="EASTERN CAPE">Eastern Cape</option>
                            <option value="FREE STATE">Free State</option>
                            <option value="GAUTENG">Gauteng</option>
                            <option value="KWAZULU-NATAL">KwaZulu-Natal</option>
                            <option value="LIMPOPO">Limpopo</option>
                            <option value="MPUMALANGA">Mpumalanga</option>
                            <option value="NORTH WEST">North West</option>
                            <option value="NORTHERN CAPE">Northern Cape</option>
                            <option value="WESTERN CAPE">Western Cape</option>
                            
                        </select>
            </div>
        </div>
        <hr>
        <div class="row">

            <div class="col-lg-6">
                <div class="card-body shadow-lg" style="height: 100%;">
                    <div class="card-header py-2" style="text-align: center; background-color: #669999;font-weight: bold;font-family: 'Speedee', sans-serif;">
                        Store Distribution by Region
                    </div>
                    <div id="container-pie-main"></div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="card-body shadow-lg" style="height: 100%;">
                    <div class="card-header py-2" style="text-align: center; background-color: #669999; font-weight: bold; font-family: 'Speedee', sans-serif;">
                        Total Audited Stores
                    </div>
                    <div id="total" class="total-text" style="text-align: center; color:  #669999; font-weight: bold; margin-top: 50px; font-size: 200px;">
                    </div>
                </div>
            </div>
            
            
            <div class="col-lg-12">
                <div class="card-body shadow-lg" style="height: 100%;">
                    <div class="card-header py-2" style="text-align: center; background-color: #669999;font-weight: bold;font-family: 'Speedee', sans-serif;">
                        Store Distribution by Region Map
                    </div>
                    <div id="container"></div>
                </div>
            </div>


            
          <!--  <div class="col-lg-3">
                <div class="card-body shadow-lg">
                    <div class="card-header py-2" style="text-align: center; background-color:#FFD200;font-weight: bold;font-family: 'Speedee', sans-serif;">
                        Upon Entrance(outside)
                    </div>
                    <div id="gauge-container" style="width: 50%; height: 50%; margin: auto;"></div>
                </div>
                <div class="card-body shadow-lg">
                    <div class="card-header py-1" style="text-align: center; background-color:#FFD200;font-weight: bold;font-family: 'Speedee', sans-serif;">
                        Main Digital Menu board and Pricing
                    </div>
                    <div id="gauge-container-new2" style="width: 50%; height: 50%; margin: auto;"></div>
                </div>
                <div class="card-body shadow-lg">
                    <div class="card-header py-2" style="text-align: center; background-color:#FFD200;font-weight: bold;font-family: 'Speedee', sans-serif;">
                        McCaf√© Main Menu
                    </div>
                    <div id="gauge-container-new4" style="width: 50%; height: 50%; margin: auto;"></div>
                </div>
            </div>
            <div class="col-lg-3">
                <div class="card-body shadow-lg">
                    <div class="card-header py-2" style="text-align: center; background-color:#FFD200;font-weight: bold;font-family: 'Speedee', sans-serif;">
                        Upon Entrance(In-store)
                    </div>
                    <div id="gauge-container-inside" style="width: 50%; height: 50%; margin: auto;"></div>
                </div>
                <div class="card-body shadow-lg">
                    <div class="card-header py-2" style="text-align: center; background-color:#FFD200;font-weight: bold;font-family: 'Speedee', sans-serif;">
                        Drive-thru
                    </div>
                    <div id="gauge-container-new1" style="width: 50%; height: 50%; margin: auto;"></div>
                </div>
                <div class="card-body shadow-lg">
                    <div class="card-header py-2" style="text-align: center; background-color:#FFD200;font-weight: bold;font-family: 'Speedee', sans-serif;">
                        Delivery
                    </div>
                    <div id="gauge-container-new3" style="width: 50%; height: 50%; margin: auto;"></div>
                </div>
            </div>-->
        </div>
        
    </div>

    
 
</body>
<footer style="background-color:  #669999; text-align: center;  position: fixed; bottom: 0; width: 100%;font-family: 'Speedee', sans-serif;">
    <p style="color: black; margin: 0;">&copy; {% now "Y" %} Flowing Visual Patterns. All rights reserved.</p>
</footer> 
</html>
<!-- Include Highcharts library -->
  

<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/maps/modules/map.js"></script>
<script src="https://code.highcharts.com/mapdata/countries/za/za-all.geo.json"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.3.6/proj4.js"></script>
<script src="https://code.highcharts.com/maps/highmaps.js"></script>
<!-- Include Highcharts library and solid-gauge module -->
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/highcharts-more.js"></script>
<script src="https://code.highcharts.com/modules/solid-gauge.js"></script>
<script>
    $(document).ready(function () {
    // Get the current date
    var currentDate = new Date();

    // Set the default "From" date to the first day of the current month
    var defaultFromDate = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1);

    // Use the current date as the default "To" date
    var defaultToDate = new Date();

    // Initialize date pickers
    $('#fromDate').datepicker({
        format: 'yyyy-mm-dd',
        autoclose: true,
        todayHighlight: true,
        startDate: defaultFromDate, // Set the default "From" date
    }).datepicker('setDate', defaultFromDate) // Set the initial date
    .on('changeDate', function (selected) {
        // Update the startDate of the "To" datepicker dynamically based on the selected date in "From" datepicker
        $('#toDate').datepicker('setStartDate', selected.date);
    });

    $('#toDate').datepicker({
        format: 'yyyy-mm-dd',
        autoclose: true,
        todayHighlight: true,
        startDate: defaultToDate, // Set the default "To" date
        beforeShowDay: function (date) {
            // Disable all dates after the month selected in the "fromDate" datepicker
            var fromDate = $('#fromDate').datepicker('getDate');
            return date >= fromDate && date <= defaultToDate ;
        }
    }).datepicker('setDate', defaultToDate); // Set the initial date
});

(async () => {
    // Load the map data for South Africa
     // Load the map data for South Africa
     const topology = await fetch(
        'https://code.highcharts.com/mapdata/countries/za/za-all.topo.json'
    ).then(response => response.json());

    const mapData = await fetch(
    'https://code.highcharts.com/mapdata/countries/za/za-all.topo.json'
).then(response => response.json());



//const storeData = await fetch('/get_map_data/').then(response => response.json());
//console.log('data')
//console.log(storeData)
/*const createMapStore = (data) => {
console.log(data)
const convertedStoreData = data.map(point => ({
    ...point,
    lat: parseFloat(point.latitude.replace(',', '.')),
    lon: parseFloat(point.longitude.replace(',', '.')),
}));

const chart = Highcharts.mapChart('container-visualizations', {

    title: {
        text: '',
    },

    legend: {
        align: 'left',
        layout: 'vertical',
        floating: true
    },

    accessibility: {
        point: {
            valueDescriptionFormat: '{xDescription}.'
        }
    },

    mapNavigation: {
        enabled: true
    },
    credits: {
                enabled: false
            },
    tooltip: {
            headerFormat: '',
            pointFormat: `
                <b>{point.site_name}</b><br>
                Physical Address: {point.physical_address}<br>
                Phone Number: {point.tel_no}<br>
                Province: {point.region__name}
            `,
            footerFormat: '',
            xDateFormat: '%Y-%m-%d %H:%M:%S'
    },
    plotOptions: {
        series: {
            marker: {
                fillColor: '#FFFFFF',
                lineWidth: 2,
                lineColor: Highcharts.getOptions().colors[1]
            }
        }
    },

    series: [{
        mapData,
        name: 'South Africa',
        borderColor: '#707070',
        nullColor: 'rgba(200, 200, 200, 0.3)',
        showInLegend: false
    }, {
        type: 'mappoint',
        name: 'Stores',
        dataLabels: {
            format: '{point.site_name}'  
        },
        data: convertedStoreData  
    }]
});

};*/

    // Function to fetch store data based on the selected province
    const fetchStoresByProvince = async (province,month) => {
        const response = await fetch(`/get_store_data/?province=${province}&month=${month}`);
            return await response.json();
    };

    const fetchStoresBylandingpage = async (province,month) => {
        const response = await fetch(`/home/?province=${province}&month=${month}`);
            return await response.json();
    };
    //const fetchStores = async (province_store, store,month) => {
    //    const response = await fetch(`/get_map_data/?province_store=${province_store}&store=${store}&month=${month}`);
    //    return await response.json();
    //};
      //Visualizations page 
     const filterDropdownbyStoreProvince = document.getElementById('filterprovincestore');
    //const filterDropdownbyStoreOwnerFranchise = document.getElementById('filterownerfranchise');
    //const filterDropdownfrom= document.getElementById('fromDate');
    //const filterDropdownto= document.getElementById('toDate');
    const filterDropdownmonth= document.getElementById('month');
    // Function to create the Highcharts map chart
    
    const createMapChart = (data) => {
        // Define colors for provinces
        const provinceColors = {
            'Western Cape': '#FF0000', // Red
            'Gauteng': '#00FF00', // Green
            'Limpopo': '#0000FF', // Blue
            // ... Add more provinces and colors as needed
        };

        // Log information about McDonald's stores
        console.log('McDonald\'s stores:', data);
        
        console.log('McDonald\'s stores:', data);
        
        const convertedStoreData = data.map(point => {
        const lat = parseFloat(point.latitude.replace(',', '.')) || 0;
        const lon = parseFloat(point.longitude.replace(',', '.')) || 0;

            return {
                ...point,
                lat,
                lon,
            };
        });

        // Create the Highcharts map chart
        // Create the Highcharts map chart
        // Create the Highcharts map chart
        Highcharts.mapChart('container', {
            title: {
                text: '',
            },
            legend: {
                align: 'left',
                layout: 'vertical',
                floating: true,
            },
            accessibility: {
                point: {
                    valueDescriptionFormat: '{xDescription}.',
                },
            },
            mapNavigation: {
                enabled: true,
            },
            credits: {
                enabled: false,
            },
            tooltip: {
                headerFormat: '',
                pointFormat: `
                    <b></b><br>
                    Audiited:{point.total}  <br>
                `,
                footerFormat: '',
                xDateFormat: '%Y-%m-%d %H:%M:%S',
            },
            plotOptions: {
                series: {
                    marker: {
                        fillColor: '#669999', // McDonald's yellow color for markers
                        lineWidth: 2,
                        lineColor: '#669999', // McDonald's yellow color for border
                    },
                },
            },
            series: [{
                mapData,  // Ensure that mapData is defined
                name: 'South Africa',
                borderColor: '#669999', // McDonald's yellow color for the map border
                color: '#669999', // McDonald's yellow color for the map
                showInLegend: false,
            }, {
                type: 'mappoint',
                name: 'Stores',
                dataLabels: {
                    format: '{point.site_name}' + ' - ' + '{point.total}' + ' Stores Audited',
                },
                data: convertedStoreData,
            }],
        }, function(chart) {
            // Get the current date and time
            const currentDate = new Date();

            // Add two hours to the current date's time
            const adjustedDate = new Date(currentDate.getTime() + 2 * 60 * 60 * 1000);

            const formattedDate = Highcharts.dateFormat('%Y-%m-%d %H:%M:%S', adjustedDate);

            // Add the date and time to the chart
            chart.setTitle({
                text: formattedDate,
            });
        });




        // Extracting data for the pie chart
        const pieChartData = data.map(store => ({
            name: store.site_name,
            y: parseInt(store.total),  // Assuming 'total' is a number
            region: store.region,
        }));

        // Custom colors aligned with McDonald's branding
        const mcdonaldsColors = {
            'Eastern Cape': '#FFD100',        // McDonald's yellow
            'Free State': '#FF0000',          // McDonald's red
            'Gauteng': '#FF1493',     // McDonald's yellow
            'KwaZulu-Natal': '#8B4513',       // McDonald's red
            'Limpopo': '#32CD32',              // McDonald's yellow
            'Mpumalanga': '#4B0082',           // McDonald's red
            'North West': '#FFFFFF',           // McDonald's yellow
            'Northern Cape': '#1E90FF',        // McDonald's red
            'Western Cape': '#FFD100',         // McDonald's yellow
        };

        // Map the colors to the pieChartData
        pieChartData.forEach(dataPoint => {
            dataPoint.color = mcdonaldsColors[dataPoint.region];
        });

        // Highcharts Pie Chart Configuration
        Highcharts.chart('container-pie-main', {
            chart: {
                type: 'pie'
            },
            title: {
                text: ''
            },
            credits: {
                enabled: false
            },
            tooltip: {
                pointFormat: '<b>{point.name}</b>: {point.y} stores'
            },
            plotOptions: {
                pie: {
                    colors: pieChartData.map(dataPoint => dataPoint.color)
                }
            },
            series: [{
                name: 'Region',
                colorByPoint: true,
                data: pieChartData
            }]
        });

    };
        const filterDropdownpro1 = document.getElementById('filter1');
        const filterDropdown1 = document.getElementById('filter1');
        filterDropdown1.addEventListener('change', async () => {
        const filterDropdownpro3 = filterDropdownpro1.value; // Move this line inside the event listener
        console.log('Provinces')
        console.log(filterDropdownpro3)
        
        if (filterDropdownpro3=="all")
        {
            const responseData = [
                // ... other store objects
                // Add central coordinates for provinces
                { "site_name": "Eastern Cape", "latitude": "-32.2968", "longitude": "26.4194", "region": "Eastern Cape","total":  "{{ num_EASTERN_CAPE_stores}}" },
                { "site_name": "Free State", "latitude": "-29.1211", "longitude": "26.2140", "region": "Free State","total":  "{{num_FREE_STATE_stores}}" },
                { "site_name": "Gauteng", "latitude": "-26.2708", "longitude": "28.1123", "region": "Gauteng","total":  "{{ num_gauteng_stores}}"},
                { "site_name": "KwaZulu-Natal", "latitude": "-29.8499", "longitude": "30.9668", "region": "KwaZulu-Natal","total":  "{{ num_KWAZULU_NATAL_stores}}" },
                { "site_name": "Limpopo", "latitude": "-23.4015", "longitude": "29.4185", "region": "Limpopo","total":  "{{ num_LIMPOPO_stores}}" },
                { "site_name": "Mpumalanga", "latitude": "-25.5653", "longitude": "30.5279", "region": "Mpumalanga","total":  "{{ num_MPUMALANGA_stores}}" },
                { "site_name": "North West", "latitude": "-25.6765", "longitude": "26.1182", "region": "North West","total":  "{{ num_NORTH_WEST_stores}}" },
                { "site_name": "Northern Cape", "latitude": "-29.0468", "longitude": "21.8569", "region": "Northern Cape","total":  "{{num_NORTHERN_CAPE_stores}}" },
                { "site_name": "Western Cape", "latitude": "-33.9180", "longitude": "18.4233", "region": "Western Cape","total":  "{{ num_WESTERN_CAPE_stores}}" }
            ];
            createMapChart(responseData);
            const divElement = document.getElementById("total");
            divElement.innerHTML = "{{total_stores}}"
        }else if(filterDropdownpro3=='EASTERN CAPE'){
            const responseData = [
              { "site_name": "Eastern Cape", "latitude": "-32.2968", "longitude": "26.4194", "region": "Eastern Cape","total":  "{{ num_EASTERN_CAPE_stores}}" },
            ];
            createMapChart(responseData);
            const divElement = document.getElementById("total");
            divElement.innerHTML = "{{ num_EASTERN_CAPE_stores}}"
        }else if(filterDropdownpro3=='FREE STATE'){
            const responseData = [
              { "site_name": "Free State", "latitude": "-29.1211", "longitude": "26.2140", "region": "Free State","total":  "{{num_FREE_STATE_stores}}" },
            ];
            createMapChart(responseData);
            const divElement = document.getElementById("total");
            divElement.innerHTML = "{{num_FREE_STATE_stores}}"
        }else if(filterDropdownpro3=='GAUTENG'){
            const responseData = [
            { "site_name": "Gauteng", "latitude": "-26.2708", "longitude": "28.1123", "region": "Gauteng","total":  "{{ num_gauteng_stores}}" },
            ];
            createMapChart(responseData);
            const divElement = document.getElementById("total");
            divElement.innerHTML = "{{ num_gauteng_stores}}"
        }else if(filterDropdownpro3=='KWAZULU-NATAL'){
            const responseData = [
            { "site_name": "KwaZulu-Natal", "latitude": "-29.8499", "longitude": "30.9668", "region": "KwaZulu-Natal","total":  "{{ num_KWAZULU_NATAL_stores}}" },
            ];
            createMapChart(responseData);
            const divElement = document.getElementById("total");
            divElement.innerHTML = "{{ num_KWAZULU_NATAL_stores}}"
        }else if(filterDropdownpro3=='LIMPOPO'){
            const responseData = [
            { "site_name": "Limpopo", "latitude": "-23.4015", "longitude": "29.4185", "region": "Limpopo","total":  "{{num_LIMPOPO_stores}}" },
            ];
            createMapChart(responseData);
            const divElement = document.getElementById("total");
            divElement.innerHTML = "{{num_LIMPOPO_stores}}"
        }else if(filterDropdownpro3=='MPUMALANGA'){
            const responseData = [
            { "site_name": "Mpumalanga Central", "latitude": "-25.5653", "longitude": "30.5279", "region": "Mpumalanga","total":  "{{ num_MPUMALANGA_stores}}" },
            ];
            createMapChart(responseData);
            const divElement = document.getElementById("total");
            divElement.innerHTML = "{{ num_MPUMALANGA_stores}}"
        }else if(filterDropdownpro3=='NORTH WEST'){
            const responseData = [
            { "site_name": "North West", "latitude": "-25.6765", "longitude": "26.1182", "region": "North West","total":  "{{ num_NORTH_WEST_stores}}" },
            ];
            createMapChart(responseData);
            const divElement = document.getElementById("total");
            divElement.innerHTML ="{{ num_NORTH_WEST_stores}}"
        }else if(filterDropdownpro3=='NORTHERN CAPE'){
            const responseData = [
            { "site_name": "Northern Cape Central", "latitude": "-29.0468", "longitude": "21.8569", "region": "Northern Cape","total":  "{{ num_NORTHERN_CAPE_stores}}" },
            ];
            createMapChart(responseData);
            const divElement = document.getElementById("total");
            divElement.innerHTML ="{{ num_NORTHERN_CAPE_stores}}"
        }else if(filterDropdownpro3=='WESTERN CAPE'){
            const responseData = [
            { "site_name": "Western Cape", "latitude": "-33.9180", "longitude": "18.4233", "region": "Western Cape","total":  "{{ num_WESTERN_CAPE_stores}}" }
            ];
            createMapChart(responseData);
            const divElement = document.getElementById("total");
            divElement.innerHTML ="{{ num_WESTERN_CAPE_stores}}"
        }
        
    });
    const creategaugeChart = (data) => {
        // Extract the summary data from the last object in the array
        const summaryData = data[data.length - 1];

        Highcharts.chart('gauge-container', {
            chart: {
                type: 'solidgauge',
            },
            title: {
                text: '',
            },
            credits: {
                enabled: false
            },
            pane: {
                center: ['50%', '85%'],
                size: '140%',
                startAngle: -90,
                endAngle: 90,
                background: {
                    backgroundColor: Highcharts.defaultOptions.legend.backgroundColor || '#EEE',
                    innerRadius: '60%',
                    outerRadius: '100%',
                    shape: 'arc',
                },
            },
            yAxis: {
                min: 0,
                max:'',
                title: {
                    text: '',
                    y: -70,
                },
                stops: [
                    [0.1, '#DF5353'], 
                    [0.5, '#DDDF0D'], 
                    [0.9, '#55BF3B'], 
                ],
                lineWidth: 0,
                tickWidth: 0,
                minorTickInterval: null,
                tickAmount: 2,
                labels: {
                    y: 16,
                },
            },
            series: [{
                name: 'Achieved',
                data: [''],
                tooltip: {
                    valueSuffix: ' units',
                },
            }],
        });

        
    };
    const creategaugeChartoutsidestorelevel = (data) => {
        // Extract the summary data from the last object in the array
        const summaryData = data[data.length - 1];

        // Assuming summaryData.total_score_outside and summaryData.target_outside are both numeric values
        const achievedPercentage = (summaryData.total_score_outside / summaryData.target_outside) * 100;
        let color;
        if (achievedPercentage >= 0 && achievedPercentage < 20) {
            color = 'red';
        } else if (achievedPercentage >= 20 && achievedPercentage < 65) {
            color = 'orange';
        } else {
            color = 'green';
        }
        Highcharts.chart('gauge-container-outside-store-level', {
            chart: {
                type: 'solidgauge',
            },
            title: {
                text: '',
            },
            credits: {
                enabled: false
            },
            pane: {
                center: ['50%', '85%'],
                size: '140%',
                startAngle: -90,
                endAngle: 90,
                background: {
                    backgroundColor: Highcharts.defaultOptions.legend.backgroundColor || '#EEE',
                    innerRadius: '60%',
                    outerRadius: '100%',
                    shape: 'arc',
                },
            },
            yAxis: {
                min: 0,
                max: 100,
                title: {
                    text: '',
                    y: -70,
                },
                stops: [
                    [0.1, 'red'],    // Red for 0% - 20%
                    [0.5, 'orange'], // Orange for 20% - 65%
                    [0.9, 'green'],  // Green for 65% - 100%
                ],
                lineWidth: 0,
                tickWidth: 0,
                minorTickInterval: null,
                tickAmount: 2,
                labels: {
                    y: 16,
                    formatter: function () {
                        // Hide labels for 0% and 100%
                        if (this.value === 0 || this.value === 100) {
                            return '';
                        } else {
                            return this.value + '%';
                        }
                    },
                },
            },
            series: [{
                name: 'Achieved',
                data: [achievedPercentage],
                dataLabels: {
                    format: '{y}%',
                    borderWidth: 0,
                    y: 10,
                    style: {
                        fontSize: '100%', // Adjust the font size as needed
                        color: color,   // Set the color to green
                    },
                },
                tooltip: {
                    valueSuffix: '%',
                },
            }],
        });



        var displayTextElement = document.getElementById('displayText');
        var displayT = document.getElementById('displayT');
        var displayTname = document.getElementById('displayTname');
        var displayTextElement2 = document.getElementById('displayText2');
        var displayTextElement3 = document.getElementById('displayText3');
        var displayTextElement4 = document.getElementById('displayText4');
        var displayTextElement5 = document.getElementById('displayText5');
        var displayTextElement6 = document.getElementById('displayText6');
        var displayTextElement8 = document.getElementById('displayText8');
        
        var displayTextElement7 = document.getElementById('displayText7');
        displayT.innerHTML = '<span style="color: black;font-Weight:bold;font-size:110%">'+'Date: </span>' + summaryData.out_campaign_outside_date;
        displayT.style.color = 'black';
        displayTname.innerHTML = '<span style="color: black;font-Weight:bold;font-size:110%">'+'Store: </span>' + summaryData.out_campaign_outside_store_site_name;
        displayTname.style.color = 'black';
            // Change the text content
            if (summaryData.out_branding_condition) {
                displayTextElement.innerHTML = '<span style="color: black;font-size:110%"><b>1.Branding features in good condition?</b></span><br>Answer:' + summaryData.out_branding_condition;
                displayTextElement.style.color = 'green';
                displayTextElement.style.fontWeight = 'bold';
                displayTextElement.classList.add('green-text');

            } else {
                displayTextElement.innerHTML = '<span style="color: black;font-size:110%"><b>1.Branding features in good condition?</b></span><br>Answer:' + summaryData.out_branding_condition;
                displayTextElement.style.color = 'red';
                displayTextElement.style.fontWeight = 'bold';
                displayTextElement.classList.add('red-text');
            }
            if (summaryData.out_signage_condition) {
                displayTextElement2.innerHTML = '<span style="color: black;font-size:110%"><b>2.Was there external disclaimer signage?</b></span><br>Answer: ' + summaryData.out_signage_condition;
                displayTextElement2.style.color = 'green';
                displayTextElement2.style.fontWeight = 'bold';
                displayTextElement2.classList.add('green-text');
            } else {
                displayTextElement2.innerHTML = '<span style="color: black;font-size:110%"><b>2.Was there external disclaimer signage?</b></span><br>Answer: ' + summaryData.out_signage_condition;
                displayTextElement2.style.color = 'red';
                displayTextElement2.style.fontWeight = 'bold';
                displayTextElement2.classList.add('red-text');
            }
            console.log(summaryData.out_campaign)
            if (summaryData.out_campaign) {
                displayTextElement3.innerHTML = '<span style="color: black;font-size:110%"><b>3. Notice any campaigns as you entered?</b></span><br>Answer: ' + summaryData.out_campaign;
                displayTextElement3.style.color = 'green';
                displayTextElement3.style.fontWeight = 'bold';
                displayTextElement3.classList.add('green-text');
            } else {
                displayTextElement3.innerHTML = '<span style="color: black;font-size:110%"><b>3.Notice any campaigns as you entered?</b></span><br>Answer: ' + summaryData.out_campaign;
                displayTextElement3.style.color = 'red';
                displayTextElement3.style.fontWeight = 'bold';
                displayTextElement3.classList.add('red-text');
            }

            if (summaryData.outsidemystorecamp) {
                displayTextElement8.innerHTML = '<span style="color: black;font-size:110%"><b>4.Were there any MyStore marketing promotions/activations outside and as you entered the store?</b></span><br>Answer: ' + summaryData.outsidemystorecamp;
                displayTextElement8.style.color = 'green';
                displayTextElement8.style.fontWeight = 'bold';
                displayTextElement8.classList.add('green-text');
            } else {
                displayTextElement8.innerHTML = '<span style="color: black;font-size:110%"><b>4.Were there any MyStore marketing promotions/activations outside and as you entered the store?</b></span><br>Answer: ' + summaryData.outsidemystorecamp;
                displayTextElement8.style.color = 'red';
                displayTextElement8.style.fontWeight = 'bold';
                displayTextElement8.classList.add('red-text');
            }
            
                
            if (summaryData.out_campaign!="false") {
                        displayTextElement5.textContent =  ' If yes, Which campaigns did you notice as you entered the store? ';
                        displayTextElement5.style.fontWeight = 'bold';
                        let promoCampaigns = summaryData.out_campaigns;

                        // Format and display the campaigns
                        let formattedCampaigns = '';
                        if (Array.isArray(promoCampaigns)) {
                            // Format and display the campaigns
                            formattedCampaigns = promoCampaigns.map(campaign => `üëç ${campaign.trim()}.`).join('<br>');
                            // Now you can use formattedCampaigns as needed
                        } else {
                            console.error("promoCampaigns is not an array. Check the data structure.");
                        }
                        displayTextElement6.innerHTML = '<br>' + formattedCampaigns;
                        displayTextElement6.style.fontWeight = 'bold';
                        displayTextElement6.style.color = 'green';
                    } else {
                        // Handle the case where summaryData.out_campaigns is not defined
                        console.error('summaryData.out_campaigns is not defined.');
                    }
            displayTextElement4.innerHTML= '<span style="color:black;font-size:110%"><b>4.Give a brief description of anything that was did not sit right/was not in good condition?</b></span><br>Answer:' + summaryData.out_description_outside;
            displayTextElement4.style.fontWeight = 'bold';
            displayTextElement4.style.color = 'green';

    };

    const creategaugeChartinsidestorelevel = (data) => {
        // Extract the summary data from the last object in the array
        const summaryData = data[data.length - 1];
        const achievedPercentage = (summaryData.total_score_inside / summaryData.target_inside) * 100;
        let color;
        if (achievedPercentage >= 0 && achievedPercentage < 20) {
            color = 'red';
        } else if (achievedPercentage >= 20 && achievedPercentage < 65) {
            color = 'orange';
        } else {
            color = 'green';
        }
        Highcharts.chart('gauge-container-inside-store-level', {
            chart: {
                type: 'solidgauge',
            },
            title: {
                text: '',
            },
            credits: {
                enabled: false
            },
            pane: {
                center: ['50%', '85%'],
                size: '140%',
                startAngle: -90,
                endAngle: 90,
                background: {
                    backgroundColor: Highcharts.defaultOptions.legend.backgroundColor || '#EEE',
                    innerRadius: '60%',
                    outerRadius: '100%',
                    shape: 'arc',
                },
            },
            yAxis: {
                min: 0,
                max: 100,
                title: {
                    text: '',
                    y: -70,
                },
                stops: [
                    [0.1, 'red'],    // Red for 0% - 20%
                    [0.5, 'orange'], // Orange for 20% - 65%
                    [0.9, 'green'],  // Green for 65% - 100%
                ],
                lineWidth: 0,
                tickWidth: 0,
                minorTickInterval: null,
                tickAmount: 2,
                labels: {
                    y: 16,
                    formatter: function () {
                        // Hide labels for 0% and 100%
                        if (this.value === 0 || this.value === 100) {
                            return '';
                        } else {
                            return this.value + '%';
                        }
                    },
                },
            },
            series: [{
                name: 'Achieved',
                data: [achievedPercentage],
                dataLabels: {
                    format: '{y}%',
                    borderWidth: 0,
                    y: 10,
                    style: {
                        fontSize: '100%', // Adjust the font size as needed
                        color: color,   // Set the color to green
                    },
                },
                tooltip: {
                    valueSuffix: '%',
                },
            }],
        });

        var displayTextElementinside = document.getElementById('displayTextinside');
        var displayinside = document.getElementById('displayinside');
        var displayinsidename = document.getElementById('displayinsidename');
        var displayTextElement12inside = document.getElementById('displayTextinside12');
        
        var displayTextElement2inside = document.getElementById('displayTextinside2');
        var displayTextElement3inside = document.getElementById('displayTextinside3');
        var displayTextElement4inside = document.getElementById('displayTextinside4');
        var displayTextElement5inside = document.getElementById('displayTextinside5');
        var displayTextElement6inside = document.getElementById('displayTextinside6');
        //var displayTextElement7inside = document.getElementById('displayTextinside7');
        var displayTextElement8inside = document.getElementById('displayTextinside8');
        
        

        var displayTextElement9inside = document.getElementById('displayTextinside9');
        var displayTextElementinside10 = document.getElementById('displayTextinside10');
        displayinside.innerHTML = '<span style="color: black;font-Weight:bold;font-size:110%">'+'Date: </span>' + summaryData.out_description_inside_date;
        displayinside.style.color = 'black';
        displayinsidename.innerHTML = '<span style="color: black;font-Weight:bold;font-size:110%">'+'Store: </span>' + summaryData.out_store_site_name;
        displayinsidename.style.color = 'black';
        
            // Change the text content
            if (summaryData.out_point_of_sale) {
                displayTextElementinside.innerHTML = '<span style="color: black;font-size:110%"><b>1.Was the window POP (Point of Purchase) as per our layout?</b></span><br>Answer: ' + summaryData.out_point_of_sale;
                displayTextElementinside.style.color = 'green';
                displayTextElementinside.style.fontWeight = 'bold';
                displayTextElementinside.classList.add('green-text');
            } else {
                displayTextElementinside.innerHTML = '<span style="color: black;font-size:110%"><b>1.Was the window POP (Point of Purchase) as per our layout?</b></span><br>Answer: ' + summaryData.out_point_of_sale;
                displayTextElementinside.style.color = 'red';
                displayTextElementinside.style.fontWeight = 'bold';
                displayTextElementinside.classList.add('red-text');
            }
            displayTextElementinside10.innerHTML = '<span style="color: black;font-Weight:bold;font-size:110%"><b>' + 'If no, give a brief description of the condition? </b></span><br>Answer:' + summaryData.out_pop_description_inside;
            displayTextElementinside10.style.color = 'green';
            
            if (summaryData.out_self_order_kiosk) {
                displayTextElement2inside.innerHTML = '<span style="color:black;font-size:110%"><b>2.Was the SOKs (Self Ording Kiosks) fully functioning with all promotional items displaying?</b></span><br>Answer: ' + summaryData.out_self_order_kiosk;
                displayTextElement2inside.style.color = 'green';
                displayTextElement2inside.style.fontWeight = 'bold';
                displayTextElement2inside.classList.add('green-text');
                
            } else {
                displayTextElement2inside.innerHTML = '<span style="color: black;font-size:110%"><b>2.Was the SOKs (Self Ording Kiosks) fully functioning with all promotional items displaying?</b></span><br>Answer:' + summaryData.out_self_order_kiosk;
                displayTextElement2inside.style.color = 'red';
                displayTextElement2inside.style.fontWeight = 'bold';
                displayTextElement2inside.classList.add('red-text');
            }

            if (summaryData.insidemystorecamp) {
                displayTextElement12inside.innerHTML = '<span style="color:black;font-size:110%"><b>3.Were there any MyStore marketing promotions/activations?</b></span><br>Answer: ' + summaryData.insidemystorecamp;
                displayTextElement12inside.style.color = 'green';
                displayTextElement12inside.style.fontWeight = 'bold';
                displayTextElement12inside.classList.add('green-text');
                
            } else {
                displayTextElement12inside.innerHTML = '<span style="color: black;font-size:110%"><b>3.Were there any MyStore marketing promotions/activations??</b></span><br>Answer:' + summaryData.insidemystorecamp;
                displayTextElement12inside.style.color = 'red';
                displayTextElement12inside.style.fontWeight = 'bold';
                displayTextElement12inside.classList.add('red-text');
            }

            if(summaryData.out_self_order_kiosk!="false"){
                displayTextElement3inside.textContent = 'Did you see the following promotions displayed on the SOK (Self Ordering Kiosk)?';
                //displayTextElement7inside.innerHTML = '- Hero Double Quarter Pounder with Cheese'+'<br>'+'- McFlurry Strawberry Shortcake'+'<br>'+'- 4 Piece Chicken Tenders'+'<br>'+'- McFizz Lemon Litchi'+'<br>'+'- Nazo'+'<br>'+'- Chillie Cheese McFlavour Fries (newly launched)'+'<br>'+'-Beef/Chicken Hamburger(McSaver Menu)'+'<br>'+'-Small coke-no sugar(McSaver Menu)'+'<br>'+'-Small Fries(McSaver Menu)'+'<br>'+'-Plain Sundae ice cream(McSaver Menu)';
                //displayTextElement7inside.style.fontWeight = 'bold';
                //displayTextElement7inside.style.backgroundColor = '#FFD700';
                displayTextElement3inside.style.fontWeight = 'bold';
                displayTextElement3inside.style.fontSize = '130%';

                // Assuming summaryData.out_promo_sok_campaigns is a string
                let promoCampaigns = summaryData.out_promo_sok_campaigns;

                // Split the string into an array using comma as a delimiter
                //let campaignsArray = promoCampaigns.split(',');

                // Format and display the campaigns
                let formattedCampaigns = '';
                if (Array.isArray(promoCampaigns)) {
                        // Format and display the campaigns
                        formattedCampaigns = promoCampaigns.map(campaign => `üëç ${campaign.trim()}.`).join('<br>');
                        // Now you can use formattedCampaigns as needed
                } else {
                                console.error("promoCampaigns is not an array. Check the data structure.");
                }
                // Now, formattedCampaigns contains the desired output
                console.log(formattedCampaigns);
                displayTextElement6inside.innerHTML = '<br>'+ formattedCampaigns;
                displayTextElement3inside.style.fontWeight = 'bold';
                displayTextElement6inside.style.color = 'green';
                displayTextElement6inside.style.fontWeight = 'bold';
            }
            displayTextElement4inside.textContent = ' Which Happy Meal campaign is currently displaying in stores?';
            displayTextElement4inside.style.fontWeight = 'bold';
            displayTextElement4inside.style.fontSize = '130%';
            //displayTextElement9inside.innerHTML = '-Happy meal with Pok√©mon toy'+'<br>'+'-Happy meal with ‚ÄòRoblox adopt me‚Äô toy';
            //displayTextElement9inside.style.fontWeight = 'bold';
           // displayTextElement9inside.style.backgroundColor = '#FFD700';
           let promoCampaigns = summaryData.out_campaigns;

            // Format and display the campaigns
            let formattedCampaigns = '';
            if (Array.isArray(promoCampaigns)) {
                    // Format and display the campaigns
                    formattedCampaigns = promoCampaigns.map(campaign => `üëç ${campaign.trim()}.`).join('<br>');
                    // Now you can use formattedCampaigns as needed
            } else {
                            console.error("promoCampaigns is not an array. Check the data structure.");
            }
            displayTextElement8inside.innerHTML = '<br>' + formattedCampaigns;
            displayTextElement8inside.style.fontWeight = 'bold';
            displayTextElement8inside.style.color  = 'green';

            displayTextElement5inside.innerHTML =  '<span style="color: black;font-size:110%"><b>Give a brief description of anything that was did not sit right/was not in good condition?</b></span><br>Answer:' + summaryData.out_description_inside;
            displayTextElement5inside.style.fontWeight = 'bold';
            displayTextElement5inside.style.color  = 'green';
    };
    const creategaugeChartmenustorelevel = (data) => {
        // Extract the summary data from the last object in the array
        const summaryData = data[data.length - 1];
        const achievedPercentage = (summaryData.total_score_Main / summaryData.target_menu) * 100;
        let color;
        if (achievedPercentage >= 0 && achievedPercentage < 20) {
            color = 'red';
        } else if (achievedPercentage >= 20 && achievedPercentage < 65) {
            color = 'orange';
        } else {
            color = 'green';
        }
        Highcharts.chart('gauge-container-menu-store-level', {
            chart: {
                type: 'solidgauge',
            },
            title: {
                text: '',
            },
            credits: {
                enabled: false
            },
            pane: {
                center: ['50%', '85%'],
                size: '140%',
                startAngle: -90,
                endAngle: 90,
                background: {
                    backgroundColor: Highcharts.defaultOptions.legend.backgroundColor || '#EEE',
                    innerRadius: '60%',
                    outerRadius: '100%',
                    shape: 'arc',
                },
            },
            yAxis: {
                min: 0,
                max: 100,
                title: {
                    text: '',
                    y: -70,
                },
                stops: [
                    [0.1, 'red'],    // Red for 0% - 20%
                    [0.5, 'orange'], // Orange for 20% - 65%
                    [0.9, 'green'],  // Green for 65% - 100%
                ],
                lineWidth: 0,
                tickWidth: 0,
                minorTickInterval: null,
                tickAmount: 2,
                labels: {
                    y: 16,
                    formatter: function () {
                        // Hide labels for 0% and 100%
                        if (this.value === 0 || this.value === 100) {
                            return '';
                        } else {
                            return this.value + '%';
                        }
                    },
                },
            },
            series: [{
                name: 'Achieved',
                data: [achievedPercentage],
                dataLabels: {
                    format: '{y}%',
                    borderWidth: 0,
                    y: 10,
                    style: {
                        fontSize: '100%', // Adjust the font size as needed
                        color: color,   // Set the color to green
                    },
                },
                tooltip: {
                    valueSuffix: '%',
                },
            }],
        });

        var displayTextElementmenu = document.getElementById('displayTextmenu');
        var displaymenu = document.getElementById('displaymenu');
        var displaymenuname = document.getElementById('displaymenuname');
        var displayTdigital = document.getElementById('displayTdigital');
        var displayTextElementmenu1 = document.getElementById('displayTextmenu1');
        var displayTextElementmenu2 = document.getElementById('displayTextmenu2');
        var displayTextElementmenu3 = document.getElementById('displayTextmenu3');
        var displayTextElementmenu4 = document.getElementById('displayTextmenu4');
        var displayTextElementmenu5 = document.getElementById('displayTextmenu5');
        var displayTextElementmenu6 = document.getElementById('displayTextmenu6');
        var displayTextElementmenu7 = document.getElementById('displayTextmenu7');

        displaymenu.innerHTML = '<span style="color: black;font-Weight:bold;font-size:110%"><b>'+'Date: </b></span>' + summaryData.description_menu_date;
        displaymenu.style.color = 'black';
        displaymenuname.innerHTML = '<span style="color: black;font-Weight:bold;font-size:110%"><b>'+'Store: </b></span>' + summaryData.description_menu_store_site_name;
        displaymenuname.style.color = 'black';
        displayTdigital.innerHTML = '<span style="color: black;font-Weight:bold;font-size:110%">'+'Digital/Static: </span>' + summaryData.digital_menu;
        displayTdigital.style.color = 'black';
            // Change the text content
            if (summaryData.menu_visibility) {
                displayTextElementmenu.innerHTML = '‚úî1'+'<span style="color: black;font-size:110%"><b>'+'.Digital menu board clearly displayed and fully functioning with all promotional items displaying?</b></span><br>Answer: ' + summaryData.menu_visibility;
                displayTextElementmenu.style.color = 'green';
                displayTextElementmenu.style.fontWeight = 'bold';
            } else {
                displayTextElementmenu.innerHTML = 'x'+'<span style="color:black;font-size:110%"><b>'+'1.Digital menu board clearly displayed and fully functioning with all promotional items displaying?</b></span><br>Answer: '  + summaryData.menu_visibility;
                displayTextElementmenu.style.color = 'red';
                displayTextElementmenu.style.fontWeight = 'bold';
            }
            

            if (summaryData.price_visibility!=0) {

                let promoCampaigns1 = summaryData.price_visibility;

                // Format and display the campaigns with the thumbs-up emoji (üëç) on new lines
                let formattedCampaigns = '';
                if (Array.isArray(promoCampaigns1)) {
                        // Format and display the campaigns
                        formattedCampaigns = promoCampaigns1.map(campaign => `üëç ${campaign.trim()}.`).join('<br>');
                        // Now you can use formattedCampaigns as needed
                } else {
                                console.error("promoCampaigns is not an array. Check the data structure.");
                }

                // Now, formattedCampaigns contains the desired output
                console.log(summaryData.price_visibility);
                displayTextElementmenu1.innerHTML = 'Looking at price points, which pricing is being advertised to customers?';
                displayTextElementmenu3.innerHTML = '<br>' +formattedCampaigns;
                displayTextElementmenu1.style.fontWeight = 'bold';
                displayTextElementmenu1.style.fontSize = '120%';
                displayTextElementmenu3.style.color  = 'green';
            } else {
                displayTextElementmenu1.innerHTML = 'Looking at price points, which pricing is being advertised to customers?<br>' +summaryData.price_visibility;

                displayTextElementmenu1.style.fontWeight = 'bold';
                displayTextElementmenu1.style.fontSize = '120%';
            }

            //displayTextElementmenu2.innerHTML = '-Regular meals displayed'+'<br>'+'-Medium meals displayed'+'<br>'+'-Large meals displayed';
            //displayTextElementmenu2.style.fontWeight = 'bold';
           // displayTextElementmenu2.style.backgroundColor = '#FFD700';

            if (summaryData.menu_promotion!=0) {
                let promoCampaigns1 = summaryData.menu_promotion;

                // Format and display the campaigns with the thumbs-up emoji (üëç) on new lines
                let formattedCampaigns = '';
                if (Array.isArray(promoCampaigns1)) {
                        // Format and display the campaigns
                        formattedCampaigns = promoCampaigns1.map(campaign => `üëç ${campaign.trim()}.`).join('<br>');
                        // Now you can use formattedCampaigns as needed
                } else {
                                console.error("promoCampaigns is not an array. Check the data structure.");
                }
                // Now, formattedCampaigns contains the desired output
                displayTextElementmenu4.innerHTML = 'Did you see the following promotions displayed on the digital Menu Board:';
                displayTextElementmenu5.innerHTML = '<br>' +formattedCampaigns;
                displayTextElementmenu4.style.fontWeight = 'bold';
                displayTextElementmenu4.style.fontSize = '120%';
                displayTextElementmenu5.style.color  = 'green';
            } else {
                displayTextElementmenu4.innerHTML = 'Did you see the following promotions displayed on the digital Menu Board:' +summaryData.menu_promotion;

                displayTextElementmenu4.style.fontWeight = 'bold';
                displayTextElementmenu4.style.fontSize = '120%';
            }

            //displayTextElementmenu6.innerHTML = '-Regular meals displayed'+'<br>'+'-Medium meals displayed'+'<br>'+'-Large meals displayed';
           // displayTextElementmenu6.style.fontWeight = 'bold';
            //displayTextElementmenu6.style.backgroundColor = '#FFD700';

            displayTextElementmenu7.innerHTML =  '<span style="color:black;font-size:110%"><b>Give a brief description of anything that was did not sit right/was not in good condition on the menu?</b></span><br>Answer:' + summaryData.description_menu;
            displayTextElementmenu7.style.fontWeight = 'bold';
            displayTextElementmenu7.style.color  = 'green';
    };
    const creategaugeChartmccafestorelevel = (data) => {
        // Extract the summary data from the last object in the array
        const summaryData = data[data.length - 1];
        const achievedPercentage = (summaryData.total_score_Mccafe / summaryData.target_mccafe) * 100;
        let color;
        if (achievedPercentage >= 0 && achievedPercentage < 20) {
            color = 'red';
        } else if (achievedPercentage >= 20 && achievedPercentage < 65) {
            color = 'orange';
        } else {
            color = 'green';
        }
        Highcharts.chart('gauge-container-mccafe-store-level', {
            chart: {
                type: 'solidgauge',
            },
            title: {
                text: '',
            },
            credits: {
                enabled: false
            },
            pane: {
                center: ['50%', '85%'],
                size: '140%',
                startAngle: -90,
                endAngle: 90,
                background: {
                    backgroundColor: Highcharts.defaultOptions.legend.backgroundColor || '#EEE',
                    innerRadius: '60%',
                    outerRadius: '100%',
                    shape: 'arc',
                },
            },
            yAxis: {
                min: 0,
                max: 100,
                title: {
                    text: '',
                    y: -70,
                },
                stops: [
                    [0.1, 'red'],    // Red for 0% - 20%
                    [0.5, 'orange'], // Orange for 20% - 65%
                    [0.9, 'green'],  // Green for 65% - 100%
                ],
                lineWidth: 0,
                tickWidth: 0,
                minorTickInterval: null,
                tickAmount: 2,
                labels: {
                    y: 16,
                    formatter: function () {
                        // Hide labels for 0% and 100%
                        if (this.value === 0 || this.value === 100) {
                            return '';
                        } else {
                            return this.value + '%';
                        }
                    },
                },
            },
            series: [{
                name: 'Achieved',
                data: [achievedPercentage],
                dataLabels: {
                    format: '{y}%',
                    borderWidth: 0,
                    y: 10,
                    style: {
                        fontSize: '100%', // Adjust the font size as needed
                        color: color,   // Set the color to green
                    },
                },
                tooltip: {
                    valueSuffix: '%',
                },
            }],
        });

        var displayTextElementmccafe = document.getElementById('displayTextmccafe');
        var displayccafe = document.getElementById('displaymccafe');
        var displayccafename = document.getElementById('displaymccafename');
        var displayTextElementmccafe5 = document.getElementById('displayTextmccafe5');
        
        var displayTextElementmccafe1 = document.getElementById('displayTextmccafe1');
        var displayTextElementmccafe2 = document.getElementById('displayTextmccafe2');
        var displayTextElementmccafe3 = document.getElementById('displayTextmccafe3');
        var displayTextElementmccafe4 = document.getElementById('displayTextmccafe4');
        displayccafe.innerHTML = '<span style="color:black;font-size:110%"><b>'+'Date: </b></span>' + summaryData.mccafe_date;
        displayccafe.style.color = 'black';
        displayccafename.innerHTML = '<span style="color: black;font-size:110%"><b>'+'Store: </b></span>' + summaryData.drive_store_site_name;
        displayccafename.style.color = 'black';
        displayTextElementmccafe5.innerHTML = '<span style="color: black;font-size:110%"><b>'+'Is the menu Digital or Static? </b></span>' + summaryData.digital_menu_mc;
        displayTextElementmccafe5.style.color = 'black';
        // Change the text content
        if (summaryData.mccafemenu_visibility) {
                displayTextElementmccafe.innerHTML = '‚úî'+'<span style="color:black;font-size:110%"><b>'+'1.Is the menu clearly displayed?</b></span><br>Answer:' + summaryData.mccafemenu_visibility;
                displayTextElementmccafe.style.color = 'green';
                displayTextElementmccafe.style.fontWeight = 'bold';
            } else {
                displayTextElementmccafe.innerHTML = 'x1'+'<span style="color: black;font-size:110%"><b>'+'.Is the menu clearly displayed?</b></span><br>Answer:'  + summaryData.mccafemenu_visibility;
                displayTextElementmccafe.style.color = 'red';
                displayTextElementmccafe.style.fontWeight = 'bold';
            }

            if (summaryData.menu_promo!=0) {
                let promoCampaigns1 = summaryData.menu_promo;

                // Split the string into an array using comma as a delimiter
                let formattedCampaigns = '';
                if (Array.isArray(promoCampaigns1)) {
                        // Format and display the campaigns
                        formattedCampaigns = promoCampaigns1.map(campaign => `üëç ${campaign.trim()}.`).join('<br>');
                        // Now you can use formattedCampaigns as needed
                } else {
                                console.error("promoCampaigns is not an array. Check the data structure.");
                }

                // Now, formattedCampaigns contains the desired output
                displayTextElementmccafe1.innerHTML = 'Did you see the following promotions displayed on the digital Menu Board:';
                displayTextElementmccafe2.innerHTML = '<br>' +formattedCampaigns;
                displayTextElementmccafe1.style.fontWeight = 'bold';
                displayTextElementmccafe2.style.color  = 'green';
                displayTextElementmccafe1.style.fontSize = '120%';
            } else {
                displayTextElementmccafe1.innerHTML = 'Did you see the following promotions displayed on the digital Menu Board:' +summaryData.menu_promo;

                displayTextElementmccafe1.style.fontWeight = 'bold';
                displayTextElementmccafe1.style.fontSize = '120%';
            }

            //displayTextElementmccafe3.innerHTML = '-Iced Latte(R26.90)'+'<br>'+'-Iced Latte(Add Doughnut for R3.00)'+'<br>'+'-Iced Latte(Add Cream R8.00)'+'<br>'+'-Other (please specify)';
            //displayTextElementmccafe3.style.fontWeight = 'bold';
            //displayTextElementmccafe3.style.backgroundColor = '#FFD700';

            displayTextElementmccafe4.innerHTML = '<span style="color:black;font-size:110%"><b> Give a brief description of anything that did not sit right/was not in good condition at McCaf√©?</b></span>'+'<br>Answer:'+summaryData.description_mccafe;
            displayTextElementmccafe4.style.fontWeight = 'bold';
            displayTextElementmccafe4.style.color  = 'green';
    };

    const creategaugeChartdrivethrustorelevel = (data) => {
        // Extract the summary data from the last object in the array
        const summaryData = data[data.length - 1];
        const achievedPercentage = (summaryData.total_score_drivethru / summaryData.target_drivethru) * 100;
        let color;
        if (achievedPercentage >= 0 && achievedPercentage < 20) {
            color = 'red';
        } else if (achievedPercentage >= 20 && achievedPercentage < 65) {
            color = 'orange';
        } else {
            color = 'green';
        }
        Highcharts.chart('gauge-container-drivethru-store-level', {
            chart: {
                type: 'solidgauge',
            },
            title: {
                text: '',
            },
            credits: {
                enabled: false
            },
            pane: {
                center: ['50%', '85%'],
                size: '140%',
                startAngle: -90,
                endAngle: 90,
                background: {
                    backgroundColor: Highcharts.defaultOptions.legend.backgroundColor || '#EEE',
                    innerRadius: '60%',
                    outerRadius: '100%',
                    shape: 'arc',
                },
            },
            yAxis: {
                min: 0,
                max: 100,
                title: {
                    text: '',
                    y: -70,
                },
                stops: [
                    [0.1, 'red'],    // Red for 0% - 20%
                    [0.5, 'orange'], // Orange for 20% - 65%
                    [0.9, 'green'],  // Green for 65% - 100%
                ],
                lineWidth: 0,
                tickWidth: 0,
                minorTickInterval: null,
                tickAmount: 2,
                labels: {
                    y: 16,
                    formatter: function () {
                        // Hide labels for 0% and 100%
                        if (this.value === 0 || this.value === 100) {
                            return '';
                        } else {
                            return this.value + '%';
                        }
                    },
                },
            },
            series: [{
                name: 'Achieved',
                data: [achievedPercentage],
                dataLabels: {
                    format: '{y}%',
                    borderWidth: 0,
                    y: 10,
                    style: {
                        fontSize: '100%', // Adjust the font size as needed
                        color: color,   // Set the color to green
                    },
                },
                tooltip: {
                    valueSuffix: '%',
                },
            }],
        });
        var displayTextElementdrivethru = document.getElementById('displayTextdrivethru');
        var displaydrivethru = document.getElementById('displaydrivethru');
        var displaydrivethruname = document.getElementById('displaydrivethruname');
        
        var displayTextElementdrivethru1 = document.getElementById('displayTextdrivethru1');
        var displayTextElementdrivethru2 = document.getElementById('displayTextdrivethru2');
        var displayTextElementdrivethru3 = document.getElementById('displayTextdrivethru3');
        var displayTextElementdrivethru4 = document.getElementById('displayTextdrivethru4');
        var displayTextElementdrivethru5 = document.getElementById('displayTextdrivethru5');
        displaydrivethru.innerHTML = '<span style="color: black;font-Weight:bold;font-size:110%"><b>'+'Date: </b></span>' + summaryData.drivethru_date;
        displaydrivethru.style.color = 'black';
        displaydrivethruname.innerHTML = '<span style="color: black;font-Weight:bold;font-size:110%"><b>'+'Store: </b></span>' + summaryData.drive_store_site_name;
        displaydrivethruname.style.color = 'black';
        if (summaryData.activation_on_promo) {
                displayTextElementdrivethru.innerHTML = '‚úî'+'<span style="color: black;font-size:110%"><b>'+'1.Is there any advertising/activations observed above related to any ongoing promotions?</b></span><br>Answer:' + summaryData.activation_on_promo;
                displayTextElementdrivethru.style.color = 'green';
                displayTextElementdrivethru.style.fontWeight = 'bold';
                
            } else {
                displayTextElementdrivethru.innerHTML = 'x'+'<span style="color:black;font-size:110%"><b>'+'1.Is there any advertising/activations observed above related to any ongoing promotions?</b></span><br>Answer: '  + summaryData.activation_on_promo;
                displayTextElementdrivethru.style.color = 'red';
                displayTextElementdrivethru.style.fontWeight = 'bold';
                displayTextElementdrivethru5.innerHTML = '<span style="color: black;font-size:110%"><b>If no, please describe the advertising/activation?</b></span><br>Answer:' +summaryData.activation_description;
                displayTextElementdrivethru5.style.fontWeight = 'bold';
                displayTextElementdrivethru5.style.color  = 'green';
            }
            
            if (summaryData.drivethru_campaign!=0) {
                let promoCampaigns1 = summaryData.drivethru_campaign;

                // Format and display the campaigns with the thumbs-up emoji (üëç) on new lines
                let formattedCampaigns = '';
                if (Array.isArray(promoCampaigns1)) {
                        // Format and display the campaigns
                        formattedCampaigns = promoCampaigns1.map(campaign => `üëç ${campaign.trim()}.`).join('<br>');
                        // Now you can use formattedCampaigns as needed
                } else {
                                console.error("promoCampaigns is not an array. Check the data structure.");
                }

                // Now, formattedCampaigns contains the desired output
                displayTextElementdrivethru1.innerHTML = 'Which campaigns did you notice as you drove in?';
                displayTextElementdrivethru2.innerHTML = '<br>' +formattedCampaigns;
                displayTextElementdrivethru1.style.fontWeight = 'bold';
                displayTextElementdrivethru2.style.color  = 'green';
                displayTextElementdrivethru1.style.fontSize = '120%';
            } else {
                displayTextElementdrivethru1.innerHTML = 'Which campaigns did you notice as you drove in?' +summaryData.drivethru_campaign;

                displayTextElementdrivethru1.style.fontWeight = 'bold';
                displayTextElementdrivethru1.style.fontSize = '120%';
            }

            displayTextElementdrivethru3.innerHTML = '<span style="color: black;font-size:110%"><b>What advertising is on the COD (Customer Order Display) as you approach the Speaker inthe drive-thru?</b></span><br>Answer:' +summaryData.customer_order_display;

            displayTextElementdrivethru3.style.fontWeight = 'bold';
            displayTextElementdrivethru3.style.color  = 'green';

            //displayTextElementdrivethru4.innerHTML = '-Hero Double Quarter Pounder with Cheese(R89.90 (Regular meal))'+'<br>'+'-McFlurry Strawberry Shortcake(R39.90)'+'<br>'+'-4 Piece Chicken Tenders(R39.90)'+'<br>'+'-McFizz Lemon Litchi(R27.00)'+'<br>'+'-Nazo(R49.90)'+'<br>'+'-Chillie cheese McFlavour Fries (newly launched)(TBC)'+'<br>'+'-Other (please specify)';
            //displayTextElementdrivethru4.style.fontWeight = 'bold';
            //displayTextElementdrivethru4.style.backgroundColor = '#FFD700';
            let driveThruElement = document.getElementById('driveThruHeader');

            // Check the conditions
            if (
            summaryData.drivethru_campaign === "N/A" &&
            summaryData.customer_order_display === 'N/A' &&
            summaryData.activation_description === 'N/A'
            ) {
            // If the conditions are true, add a red line in the middle of "Drive-thru"
            driveThruElement.innerHTML = '<span style="position: relative;">Drive<span style="border-top: 2px solid red; display: inline-block; position: absolute; top: 50%; transform: translateY(-50%); margin: 0 2px;"></span>thru <span style="color: red;">x</span></span>';
            } else {
            // If the conditions are false, display "Drive-thru" without the red line
            driveThruElement.innerHTML = 'Drive-thru';
            }

    };

    const creategaugeChartdeliverystorelevel = (data) => {
        // Extract the summary data from the last object in the array
        const summaryData = data[data.length - 1];
        const achievedPercentage = (summaryData.total_score_delivery/ summaryData.target_delivery) * 100;
        let color;
        if (achievedPercentage >= 0 && achievedPercentage < 20) {
            color = 'red';
        } else if (achievedPercentage >= 20 && achievedPercentage < 65) {
            color = 'orange';
        } else {
            color = 'green';
        }
        console.log('mccafe')
        console.log(summaryData.mccafe_date)
        if (summaryData.mccafe_date=0) {
            var total_percentage = (summaryData.total_score_delivery + summaryData.total_score_drivethru  + summaryData.total_score_Main + summaryData.total_score_inside + summaryData.total_score_outside) / 11; 
            
        } else if(summaryData.drivethru_date=0) {
            var total_percentage = (summaryData.total_score_delivery + summaryData.total_score_Mccafe + summaryData.total_score_Main + summaryData.total_score_inside + summaryData.total_score_outside) / 11;
            
        }
        else{
            var total_percentage = (summaryData.total_score_delivery + summaryData.total_score_drivethru + summaryData.total_score_Mccafe + summaryData.total_score_Main + summaryData.total_score_inside + summaryData.total_score_outside) / 12;
        }
        // Calculate total percentage
        
        

        // Round the total percentage to two decimal places
        total_percentage = total_percentage*100;

        let color1;
        if (total_percentage >= 0 && total_percentage < 20) {
            color1 = 'red';
        } else if (total_percentage>= 20 && total_percentage < 65) {
            color1 = 'orange';
        } else {
            color1 = 'green';
        }
        console.log('Total Percentage:', total_percentage);
        // Create the chart using Highcharts
        Highcharts.chart('container-compare', {
            chart: {
                        type: 'solidgauge',
                    },
                    title: {
                        text: summaryData.selected_store_name,
                    },
                    credits: {
                        enabled: false
                    },
                    pane: {
                        center: ['50%', '85%'],
                        size: '140%',
                        startAngle: -90,
                        endAngle: 90,
                        background: {
                            backgroundColor: Highcharts.defaultOptions.legend.backgroundColor || '#EEE',
                            innerRadius: '60%',
                            outerRadius: '100%',
                            shape: 'arc',
                        },
                    },
                    yAxis: {
                        min: 0,
                        max: 100, // Assuming total_score_outside is a percentage (adjust as needed)
                        title: {
                            text: '',
                            y: -70,
                        },
                        stops: [
                            [0.1, 'red'],    // Red for 0% - 20%
                            [0.6, 'orange'], // Orange for 20% - 65%
                            [0.9, 'green'],  // Green for 65% - 100%
                        ],
                        lineWidth: 0,
                        tickWidth: 0,
                        minorTickInterval: null,
                        tickAmount: 2,
                        labels: {
                            y: 16,
                        },
                    },
                    series: [{
                        name: 'Achieved',
                        data: [total_percentage],
                        dataLabels: {
                            format: '{y}%',
                            borderWidth: 0,
                            y: 10,
                            style: {
                                fontSize: '170%', // Adjust the font size as needed
                                color: color1,   // Set the color to green
                            },
                        },
                        tooltip: {
                            valueSuffix: '%',
                        },
                    }],
                    
        });
        

        // Assuming you have individual scores and target values
        const data2 = {
        total_score_delivery: summaryData.total_score_delivery,
        total_score_drivethru: summaryData.total_score_drivethru,
        total_score_Mccafe: summaryData.total_score_Mccafe,
        total_score_Main: summaryData.total_score_Main,
        total_score_inside: summaryData.total_score_inside,
        total_score_outside: summaryData.total_score_outside
        };

        const targets = {
        target_delivery: 2,
        target_drivethru: 1,
        target_Mccafe: 1,
        target_Main: 1,
        target_inside: 3,
        target_outside: 4
        };
        // Create series data for bars
        const barData = Object.values(data2);
        const targetData = Object.values(targets);

        // Calculate total percentage
        const total_percentage2 = (barData.reduce((acc, score) => acc + score, 0) / (barData.length * 100)) * 100;

        // Create the chart using Highcharts
        // Calculate the total sum of scores
        const totalSum = (
            summaryData.total_score_delivery +
            summaryData.total_score_drivethru +
            summaryData.total_score_Mccafe +
            summaryData.total_score_Main +
            summaryData.total_score_inside +
            summaryData.total_score_outside
        );

        // Convert scores to percentages
        const percentageDelivery = (summaryData.total_score_delivery / totalSum) * 100;
        const percentageDriveThru = (summaryData.total_score_drivethru / totalSum) * 100;
        const percentageMccafe = (summaryData.total_score_Mccafe / totalSum) * 100;
        const percentageMain = (summaryData.total_score_Main / totalSum) * 100;
        const percentageInside = (summaryData.total_score_inside / totalSum) * 100;
        const percentageOutside = (summaryData.total_score_outside / totalSum) * 100;

        

        Highcharts.chart('container-compare-bar', {
        chart: {
            type: 'column'
        },
        title: {
            text: summaryData.selected_store_name
        },
        xAxis: {
            categories: Object.keys(data2)
        },
        yAxis: {
            title: {
            text: 'Score'
            }
        },
        plotOptions: {
            column: {
            stacking: 'normal',
            dataLabels: {
                enabled: true
            }
            }
        },
        series: [{
            name: 'Score',
            data: barData,
            color: '#669999' // Adjust the color as needed
        }, {
            name: 'Target',
            type: 'line',
            data: targetData,
            color: 'red' // Adjust the color as needed
        }],
        credits: {
            enabled: false
        }
        });

        Highcharts.chart('gauge-container-delivery-store-level', {
            chart: {
                type: 'solidgauge',
            },
            title: {
                text: '',
            },
            credits: {
                enabled: false
            },
            pane: {
                center: ['50%', '85%'],
                size: '140%',
                startAngle: -90,
                endAngle: 90,
                background: {
                    backgroundColor: Highcharts.defaultOptions.legend.backgroundColor || '#EEE',
                    innerRadius: '60%',
                    outerRadius: '100%',
                    shape: 'arc',
                },
            },
            yAxis: {
                min: 0,
                max: 100,
                title: {
                    text: '',
                    y: -70,
                },
                stops: [
                    [0.1, 'red'],    // Red for 0% - 20%
                    [0.5, 'orange'], // Orange for 20% - 65%
                    [0.9, 'green'],  // Green for 65% - 100%
                ],
                lineWidth: 0,
                tickWidth: 0,
                minorTickInterval: null,
                tickAmount: 2,
                labels: {
                    y: 16,
                    formatter: function () {
                        // Hide labels for 0% and 100%
                        if (this.value === 0 || this.value === 100) {
                            return '';
                        } else {
                            return this.value + '%';
                        }
                    },
                },
            },
            series: [{
                name: 'Achieved',
                data: [achievedPercentage],
                dataLabels: {
                    format: '{y}%',
                    borderWidth: 0,
                    y: 10,
                    style: {
                        fontSize: '100%', // Adjust the font size as needed
                        color: color,   // Set the color to green
                    },
                },
                tooltip: {
                    valueSuffix: '%',
                },
            }],
        });
        var displayTextElementdelivery = document.getElementById('displayTextdelivery');
        var displaydelivery = document.getElementById('displaydelivery');
        var displaydeliveryname = document.getElementById('displaydeliveryname');
        var displayTextElementdelivery1 = document.getElementById('displayTextdelivery1');
        var displayTextElementdelivery2 = document.getElementById('displayTextdelivery2');
        displaydelivery.innerHTML = '<span style="color: black;font-Weight:bold;font-size:110%"><b>'+'Date: </b></span>' + summaryData.delivery_date;
        displaydelivery.style.color = 'black';
        displaydeliveryname.innerHTML = '<span style="color: black;font-Weight:bold;font-size:110%"><b>'+'Store: </b></span>' + summaryData.store_site_name;
        displaydeliveryname.style.color = 'black';
        if (summaryData.mc_delivery) {
                displayTextElementdelivery.innerHTML = '‚úî'+'<span style="color: black;font-Weight:bold;font-size:110%"><b>'+'1.Is the McDelivery advertising visible?</b></span><br>Answer: ' + summaryData.mc_delivery;
                displayTextElementdelivery.style.color = 'green';
                displayTextElementdelivery.style.fontWeight = 'bold';
                
            } else {
                displayTextElementdelivery.innerHTML = 'x'+'<span style="color: black;font-Weight:bold;font-size:110%"><b>'+'1.Is the McDelivery advertising visible?</b></span><br>Answer: '  + summaryData.mc_delivery;
                displayTextElementdelivery.style.color = 'red';
                displayTextElementdelivery.style.fontWeight = 'bold';
            }
            if (summaryData.third_party_del) {
                displayTextElementdelivery1.innerHTML = '‚úî'+'<span style="color: black;font-Weight:bold;font-size:110%"><b>'+'2.Did you see Any Delivery advertising from 3 rd party (Uber eats or MrD)?</b></span><br>Answer: ' + summaryData.third_party_del;
                displayTextElementdelivery1.style.color = 'green';
                displayTextElementdelivery1.style.fontWeight = 'bold';
                
            } else {
                displayTextElementdelivery1.innerHTML = 'x'+'<span style="color: black;font-Weight:bold;font-size:110%"><b>'+'2.Did you see Any Delivery advertising from 3 rd party (Uber eats or MrD)?</b></span><br>Answer:'  + summaryData.third_party_del;
                displayTextElementdelivery1.style.color = 'red';
                displayTextElementdelivery1.style.fontWeight = 'bold';
            }

            displayTextElementdelivery2.innerHTML = '<span style="color: black;font-Weight:bold;font-size:110%"><b>3.Give a brief description of what you have observed about the drive-through?</b></span><br>Answer:'  + summaryData.description_delivery;
            displayTextElementdelivery2.style.fontWeight = 'bold';
            displayTextElementdelivery2.style.color  = 'green';

    };
    

    const creategaugeChartinside = (data) => {
        // Extract the summary data from the last object in the array
        const summaryData = data[data.length - 1];

        Highcharts.chart('gauge-container-inside', {
            chart: {
                type: 'solidgauge',
            },
            title: {
                text: '',
            },
            credits: {
                enabled: false
            },
            pane: {
                center: ['50%', '85%'],
                size: '140%',
                startAngle: -90,
                endAngle: 90,
                background: {
                    backgroundColor: Highcharts.defaultOptions.legend.backgroundColor || '#EEE',
                    innerRadius: '60%',
                    outerRadius: '100%',
                    shape: 'arc',
                },
            },
            yAxis: {
                min: 0,
                max: '',
                title: {
                    text: '',
                    y: -70,
                },
                stops: [
                    [0.1, '#DF5353'], 
                    [0.5, '#DDDF0D'], 
                    [0.9, '#55BF3B'],
                ],
                lineWidth: 0,
                tickWidth: 0,
                minorTickInterval: null,
                tickAmount: 2,
                labels: {
                    y: 16,
                },
            },
            series: [{
                name: 'Achieved',
                data: [''],
                tooltip: {
                    valueSuffix: ' units',
                },
            }],
        });

        
    };
    
    const creategaugeChartMainDigitalMenu = (data) => {
        // Extract the summary data from the last object in the array
        const summaryData = data[data.length - 1];

        Highcharts.chart('gauge-container-new2', {
            chart: {
                type: 'solidgauge',
            },
            title: {
                text: '',
            },
            credits: {
                enabled: false
            },
            pane: {
                center: ['50%', '85%'],
                size: '140%',
                startAngle: -90,
                endAngle: 90,
                background: {
                    backgroundColor: Highcharts.defaultOptions.legend.backgroundColor || '#EEE',
                    innerRadius: '60%',
                    outerRadius: '100%',
                    shape: 'arc',
                },
            },
            yAxis: {
                min: 0,
                max: '',
                title: {
                    text: '',
                    y: -70,
                },
                stops: [
                    [0.1, '#DF5353'], 
                    [0.5, '#DDDF0D'], 
                    [0.9, '#55BF3B'],
                ],
                lineWidth: 0,
                tickWidth: 0,
                minorTickInterval: null,
                tickAmount: 2,
                labels: {
                    y: 16,
                },
            },
            series: [{
                name: 'Achieved',
                data: [''],
                tooltip: {
                    valueSuffix: ' units',
                },
            }],
        });

        
    };

    const creategaugeChartDrivethru = (data) => {
        // Extract the summary data from the last object in the array
        const summaryData = data[data.length - 1];

        Highcharts.chart('gauge-container-new1', {
            chart: {
                type: 'solidgauge',
            },
            title: {
                text: '',
            },
            credits: {
                enabled: false
            },
            pane: {
                center: ['50%', '85%'],
                size: '140%',
                startAngle: -90,
                endAngle: 90,
                background: {
                    backgroundColor: Highcharts.defaultOptions.legend.backgroundColor || '#EEE',
                    innerRadius: '60%',
                    outerRadius: '100%',
                    shape: 'arc',
                },
            },
            yAxis: {
                min: 0,
                max: '',
                title: {
                    text: '',
                    y: -70,
                },
                stops: [
                    [0.1, '#DF5353'], 
                    [0.5, '#DDDF0D'], 
                    [0.9, '#55BF3B'],
                ],
                lineWidth: 0,
                tickWidth: 0,
                minorTickInterval: null,
                tickAmount: 2,
                labels: {
                    y: 16,
                },
            },
            series: [{
                name: 'Achieved',
                data: [ ''],
                tooltip: {
                    valueSuffix: ' units',
                },
            }],
        });

        
    };

    const creategaugeChartMcCafMain = (data) => {
        // Extract the summary data from the last object in the array
        const summaryData = data[data.length - 1];

        Highcharts.chart('gauge-container-new4', {
            chart: {
                type: 'solidgauge',
            },
            title: {
                text: '',
            },
            credits: {
                enabled: false
            },
            pane: {
                center: ['50%', '85%'],
                size: '140%',
                startAngle: -90,
                endAngle: 90,
                background: {
                    backgroundColor: Highcharts.defaultOptions.legend.backgroundColor || '#EEE',
                    innerRadius: '60%',
                    outerRadius: '100%',
                    shape: 'arc',
                },
            },
            yAxis: {
                min: 0,
                max: '',
                title: {
                    text: '',
                    y: -70,
                },
                stops: [
                    [0.1, '#DF5353'], 
                    [0.5, '#DDDF0D'], 
                    [0.9, '#55BF3B'],
                ],
                lineWidth: 0,
                tickWidth: 0,
                minorTickInterval: null,
                tickAmount: 2,
                labels: {
                    y: 16,
                },
            },
            series: [{
                name: 'Achieved',
                data: [''],
                tooltip: {
                    valueSuffix: ' units',
                },
            }],
        });

        
    };

    const creategaugeChartDelivery = (data) => {
        // Extract the summary data from the last object in the array
        const summaryData = data[data.length - 1];

        Highcharts.chart('gauge-container-new3', {
            chart: {
                type: 'solidgauge',
            },
            title: {
                text: '',
            },
            credits: {
                enabled: false
            },
            pane: {
                center: ['50%', '85%'],
                size: '140%',
                startAngle: -90,
                endAngle: 90,
                background: {
                    backgroundColor: Highcharts.defaultOptions.legend.backgroundColor || '#EEE',
                    innerRadius: '60%',
                    outerRadius: '100%',
                    shape: 'arc',
                },
            },
            yAxis: {
                min: 0,
                max: '',
                title: {
                    text: '',
                    y: -70,
                },
                stops: [
                    [0.1, '#DF5353'], 
                    [0.5, '#DDDF0D'], 
                    [0.9, '#55BF3B'],
                ],
                lineWidth: 0,
                tickWidth: 0,
                minorTickInterval: null,
                tickAmount: 2,
                labels: {
                    y: 16,
                },
            },
            series: [{
                name: 'Achieved',
                data: [''],
                tooltip: {
                    valueSuffix: ' units',
                },
            }],
        });

        
    };
    
    // Initial rendering of the map with all stores
    const filterDropdownmonth22 = document.getElementById('month_main');

    // Get the last option in the dropdown
    const selectedMonth22 = filterDropdownmonth22.options[filterDropdownmonth22.options.length - 1].value;
    const allStoresResponse = await fetchStoresByProvince('all',selectedMonth22);
    //const allStoresResponse = '';
    const filterDropdownbyStoreStorestarts =1;
    const selectedStorestart = filterDropdownbyStoreStorestarts.value;
    var currentDate = new Date();
    // Get the current date
    var day = currentDate.getDate();
    var month = currentDate.getMonth() + 1; // Month is zero-based, so add 1
    var year = currentDate.getFullYear();

    // Format the date as needed
    var formattedDate = year + '-' + (month < 10 ? '0' : '') + month + '-' + (day < 10 ? '0' : '') + day;
    console.log('Date:')
    console.log(formattedDate)
    //const allStoresByStore=await fetchStores('all',selectedStorestart,'January_2024');
    const allStoresByStore='';

    const allStoresby = await allStoresByStore;

    const allStores = await allStoresResponse;
    //const allStores ='';
    //createMapStore(allStoresby);
    
    const responseData2 = [
                // ... other store objects
                // Add central coordinates for provinces
                { "site_name": "Eastern Cape", "latitude": "-32.2968", "longitude": "26.4194", "region": "Eastern Cape","total":  "{{ num_EASTERN_CAPE_stores}}" },
                { "site_name": "Free State", "latitude": "-29.1211", "longitude": "26.2140", "region": "Free State","total":  "{{num_FREE_STATE_stores}}" },
                { "site_name": "Gauteng", "latitude": "-26.2708", "longitude": "28.1123", "region": "Gauteng","total":  "{{ num_gauteng_stores}}"},
                { "site_name": "KwaZulu-Natal", "latitude": "-29.8499", "longitude": "30.9668", "region": "KwaZulu-Natal","total":  "{{ num_KWAZULU_NATAL_stores}}" },
                { "site_name": "Limpopo", "latitude": "-23.4015", "longitude": "29.4185", "region": "Limpopo","total":  "{{ num_LIMPOPO_stores}}" },
                { "site_name": "Mpumalanga", "latitude": "-25.5653", "longitude": "30.5279", "region": "Mpumalanga","total":  "{{ num_MPUMALANGA_stores}}" },
                { "site_name": "North West", "latitude": "-25.6765", "longitude": "26.1182", "region": "North West","total":  "{{ num_NORTH_WEST_stores}}" },
                { "site_name": "Northern Cape", "latitude": "-29.0468", "longitude": "21.8569", "region": "Northern Cape","total":  "{{ num_NORTHERN_CAPE_stores}}" },
                { "site_name": "Western Cape", "latitude": "-33.9180", "longitude": "18.4233", "region": "Western Cape","total":  "{{ num_WESTERN_CAPE_stores}}" },
                
    ];
    const divElement = document.getElementById("total");
    divElement.innerHTML = "{{total_stores}}"
    createMapChart(responseData2);
    creategaugeChart(allStores);
    creategaugeChartinside(allStores);
    creategaugeChartMainDigitalMenu(allStores);
    creategaugeChartDrivethru(allStores);
    creategaugeChartMcCafMain(allStores);
    creategaugeChartDelivery(allStores);

    // Listen for changes in the dropdown selection
    const filterDropdown = document.getElementById('filter1');
    const filterDropdownmonth2 = document.getElementById('month_main');
    filterDropdown.addEventListener('change', async () => {
        const selectedProvince = filterDropdown.value;
        const selectedMonth = filterDropdownmonth2.value;
        const filteredStoresResponse = await fetchStoresByProvince(selectedProvince,selectedMonth);
        const filteredStores = await filteredStoresResponse;
        createMapChart(filteredStores);
        creategaugeChart(filteredStores);
        creategaugeChartinside(filteredStores);
        creategaugeChartMainDigitalMenu(filteredStores);
        creategaugeChartDrivethru(filteredStores);
        creategaugeChartMcCafMain(filteredStores);
        creategaugeChartDelivery(filteredStores);

    });

    


    
})();


$(document).ready(function () {
        // Handle navigation clicks
        $("header a").click(function (e) {
            e.preventDefault();
            var target = $(this).attr("href");
            $(".container").removeClass("active");
            $(target).addClass("active");
        });
    });
</script>